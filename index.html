<!DOCTYPE html>

<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Cultura - Cultural Tourism Platform</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
<script id="tailwind-config">
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              "primary": "#ee8c2b",
              "background-light": "#fcfaf8",
              "background-dark": "#1b140d",
              "text-light": "#1b140d",
              "text-dark": "#f3ede7",
              "card-light": "#ffffff",
              "card-dark": "#2a221a",
              "border-light": "#f3ede7",
              "border-dark": "#393027",
              "muted-light": "#9a734c",
              "muted-dark": "#a89078"
            },
            fontFamily: {
              "display": ["Plus Jakarta Sans", "Noto Sans", "sans-serif"]
            },
            borderRadius: {"DEFAULT": "0.5rem", "lg": "0.75rem", "xl": "1rem", "full": "9999px"},
          },
        },
      }
    </script>
<style>
        .material-symbols-outlined {
            font-variation-settings:
            'FILL' 0,
            'wght' 400,
            'GRAD' 0,
            'opsz' 24
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark font-display text-text-light dark:text-text-dark">
<div class="flex min-h-screen w-full flex-col">
<!-- Top Navigation Bar -->
<header class="sticky top-0 z-20 flex w-full items-center justify-between whitespace-nowrap border-b border-solid border-border-light dark:border-border-dark bg-background-light/80 dark:bg-background-dark/80 px-6 py-3 backdrop-blur-sm md:px-10">
<a href="./index.html" class="flex items-center gap-4">
<span class="material-symbols-outlined text-primary text-2xl">
                    travel_explore
                </span>
<h2 class="text-xl font-bold tracking-[-0.015em] text-text-light dark:text-text-dark">Cultura</h2>
</a>
<div class="hidden items-center gap-9 md:flex">
<a class="text-sm font-medium text-text-light dark:text-text-dark" href="./index.html">Home</a>
<a class="text-sm font-medium text-muted-light dark:text-muted-dark" href="./profile.html">My Trips</a>
<a class="text-sm font-medium text-muted-light dark:text-muted-dark" href="./city-explorer.html">Search Location</a>
<a class="text-sm font-medium text-muted-light dark:text-muted-dark" href="./booking.html">Book Trip</a>
</div>
<div class="flex items-center gap-2">
    <a href="./login.html" id="login-btn" class="flex min-w-[84px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-primary text-text-light text-sm font-bold leading-normal tracking-[0.015em]">
        <span class="truncate">Log In</span>
    </a>
    <a href="./registration.html" id="signup-btn" class="hidden md:flex min-w-[84px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-transparent border border-primary text-primary text-sm font-bold">
        <span class="truncate">Sign Up</span>
    </a>
    <div id="profile-container" class="hidden items-center gap-2">
        <span id="user-name" class="text-sm font-medium"></span>
        <div id="user-avatar" class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10" data-alt="User profile picture"></div>
        <button id="logout-btn" class="flex items-center justify-center h-10 px-2 text-muted-light dark:text-muted-dark hover:text-primary"><span class="material-symbols-outlined">logout</span></button>
    </div>
</div>
</header>
<div class="flex flex-1">
<!-- Persistent Left Sidebar -->
<aside class="sticky top-[69px] h-[calc(100vh-69px)] w-80 flex-shrink-0 border-r border-border-light dark:border-border-dark p-6 hidden lg:flex flex-col gap-6">
<div class="flex flex-col">
<h1 class="text-lg font-bold text-text-light dark:text-text-dark">Search &amp; Filter</h1>
<p class="text-sm text-muted-light dark:text-muted-dark">Find your next journey</p>
</div>
<label class="flex flex-col w-full">
<div class="flex w-full flex-1 items-stretch rounded-lg h-12">
<div class="text-muted-light dark:text-muted-dark flex bg-card-light dark:bg-card-dark items-center justify-center pl-4 rounded-l-lg border border-border-light dark:border-border-dark border-r-0">
<span class="material-symbols-outlined">search</span>
</div>
<input id="search-input" class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-r-lg text-text-light dark:text-text-dark focus:outline-0 focus:ring-1 focus:ring-primary border border-border-light dark:border-border-dark bg-card-light dark:bg-card-dark h-full placeholder:text-muted-light dark:placeholder:text-muted-dark px-4 border-l-0 pl-2 text-base font-normal leading-normal" placeholder="Search destinations..." value=""/>
</div>
</label>
<!-- Accordion Filters -->
<div class="flex flex-col">
<details class="flex flex-col border-t border-border-light dark:border-border-dark py-2 group" open="">
<summary class="flex cursor-pointer list-none items-center justify-between gap-6 py-2">
<p class="text-sm font-medium text-text-light dark:text-text-dark">Interest</p>
<span class="material-symbols-outlined text-text-light dark:text-text-dark group-open:rotate-180 transition-transform">expand_more</span>
</summary>
<div id="interest-filters" class="flex flex-col gap-2 pt-2">
<label class="flex gap-x-3 items-center">
<input checked="" class="h-5 w-5 rounded border-border-light dark:border-border-dark border-2 bg-transparent text-primary checked:bg-primary checked:border-primary focus:ring-0 focus:ring-offset-0" type="checkbox"/>
<p class="text-sm font-normal text-text-light dark:text-text-dark">History &amp; Heritage</p>
</label>
<label class="flex gap-x-3 items-center">
<input class="h-5 w-5 rounded border-border-light dark:border-border-dark border-2 bg-transparent text-primary checked:bg-primary checked:border-primary focus:ring-0 focus:ring-offset-0" type="checkbox"/>
<p class="text-sm font-normal text-text-light dark:text-text-dark">Culinary Delights</p>
</label>
<label class="flex gap-x-3 items-center">
<input class="h-5 w-5 rounded border-border-light dark:border-border-dark border-2 bg-transparent text-primary checked:bg-primary checked:border-primary focus:ring-0 focus:ring-offset-0" type="checkbox"/>
<p class="text-sm font-normal text-text-light dark:text-text-dark">Local Lifestyle</p>
</label>
<label class="flex gap-x-3 items-center">
<input class="h-5 w-5 rounded border-border-light dark:border-border-dark border-2 bg-transparent text-primary checked:bg-primary checked:border-primary focus:ring-0 focus:ring-offset-0" type="checkbox"/>
<p class="text-sm font-normal text-text-light dark:text-text-dark">Art &amp; Artisans</p>
</label>
<label class="flex gap-x-3 items-center">
<input class="h-5 w-5 rounded border-border-light dark:border-border-dark border-2 bg-transparent text-primary checked:bg-primary checked:border-primary focus:ring-0 focus:ring-offset-0" type="checkbox"/>
<p class="text-sm font-normal text-text-light dark:text-text-dark">Nature</p>
</label>
</div>
</details>
<details class="flex flex-col border-t border-border-light dark:border-border-dark py-2 group">
<summary class="flex cursor-pointer list-none items-center justify-between gap-6 py-2">
<p class="text-sm font-medium text-text-light dark:text-text-dark">Accommodation</p>
<span class="material-symbols-outlined text-text-light dark:text-text-dark group-open:rotate-180 transition-transform">expand_more</span>
</summary>
<!-- Content for Accommodation filter -->
</details>
<details class="flex flex-col border-t border-t-border-light dark:border-t-border-dark py-2 group">
<summary class="flex cursor-pointer list-none items-center justify-between gap-6 py-2">
<p class="text-sm font-medium text-text-light dark:text-text-dark">Price Range</p>
<span class="material-symbols-outlined text-text-light dark:text-text-dark group-open:rotate-180 transition-transform">expand_more</span>
</summary>
<div id="price-range-filter" class="flex flex-col gap-2 pt-2">
<div class="flex justify-between items-center text-sm text-muted-light dark:text-muted-dark">
<span>₹0</span><span id="price-range-value">₹70000</span>
</div>
<input id="price-range-slider" type="range" min="0" max="70000" value="70000" class="w-full h-2 bg-border-light rounded-lg appearance-none cursor-pointer dark:bg-border-dark accent-primary"/>
</div>
</details>
</div>
<div class="mt-auto flex flex-col gap-2">
<button id="apply-filters-btn" class="flex w-full cursor-pointer items-center justify-center overflow-hidden rounded-lg h-11 px-4 bg-primary text-text-light text-sm font-bold">Apply Filters</button>
<button id="reset-filters-btn" class="flex w-full cursor-pointer items-center justify-center overflow-hidden rounded-lg h-11 px-4 text-sm font-medium text-muted-light dark:text-muted-dark">Reset</button>
</div>
</aside>
<!-- Main Content Area -->
<main class="w-full flex-1 p-6 lg:p-10">
<!-- Hero Section -->
<section class="relative flex min-h-[400px] w-full flex-col items-center justify-center overflow-hidden rounded-xl bg-cover bg-center p-8 text-center text-white">
<div class="absolute inset-0 bg-black/50 z-0"></div>
<div class="absolute inset-0 bg-cover bg-center" data-alt="A vibrant, sunlit Italian coastal town with colorful houses built into the cliffside." style="background-image: url('https://source.unsplash.com/1600x900/?travel,culture,vibrant')"></div>
<div class="relative z-10 flex flex-col items-center gap-4">
<h1 class="text-4xl font-extrabold md:text-5xl">Your Authentic Cultural Journey Starts Here.</h1>
<p class="max-w-xl text-lg text-white/90">Discover the world's richest history, food, and traditions.</p>
</div>
</section>
<!-- Tab Navigation -->
<nav class="mt-8 border-b border-border-light dark:border-border-dark">
<div class="flex items-center gap-6">
<a class="border-b-2 border-primary py-3 text-sm font-semibold text-text-light dark:text-text-dark" href="#">Explore All</a>
</div>
</nav>
<!-- Content Grid Section -->
<section class="mt-8">
<div class="flex items-center justify-between">
<h3 class="text-2xl font-bold">Featured Destinations</h3>
<a class="text-sm font-medium text-primary hover:underline" href="#">See All</a>
</div>
<div class="mt-6 grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4" id="destinations-grid">
<!-- Dynamic destination cards will be inserted here -->
<div class="h-64 rounded-lg bg-card-light dark:bg-card-dark shadow-sm flex items-center justify-center text-muted-light dark:text-muted-dark text-sm">Loading destinations...</div>
<div class="h-64 rounded-lg bg-card-light dark:bg-card-dark shadow-sm flex items-center justify-center text-muted-light dark:text-muted-dark text-sm">Loading destinations...</div>
<div class="h-64 rounded-lg bg-card-light dark:bg-card-dark shadow-sm flex items-center justify-center text-muted-light dark:text-muted-dark text-sm">Loading destinations...</div>
<div class="h-64 rounded-lg bg-card-light dark:bg-card-dark shadow-sm flex items-center justify-center text-muted-light dark:text-muted-dark text-sm">Loading destinations...</div>
</div>
</section>
<!-- Curated Food Trails Section -->
<section class="mt-12">
<div class="flex items-center justify-between">
<h3 class="text-2xl font-bold">Curated Food Trails</h3>
<a class="text-sm font-medium text-primary hover:underline" href="./food.html">See All</a>
</div>
<div class="mt-6 grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4" id="food-trails-grid">
<!-- Placeholder for food trail cards -->
<div class="h-64 rounded-lg bg-card-light dark:bg-card-dark shadow-sm flex items-center justify-center text-muted-light dark:text-muted-dark text-sm">Loading food trails...</div>
<div class="h-64 rounded-lg bg-card-light dark:bg-card-dark shadow-sm flex items-center justify-center text-muted-light dark:text-muted-dark text-sm">Loading food trails...</div>
<div class="h-64 rounded-lg bg-card-light dark:bg-card-dark shadow-sm flex items-center justify-center text-muted-light dark:text-muted-dark text-sm">Loading food trails...</div>
<div class="h-64 rounded-lg bg-card-light dark:bg-card-dark shadow-sm flex items-center justify-center text-muted-light dark:text-muted-dark text-sm">Loading food trails...</div>
</div>
</section>
<!-- Unique Stays Section -->
<section class="mt-12">
<div class="flex items-center justify-between">
<h3 class="text-2xl font-bold">Unique Stays</h3>
<a class="text-sm font-medium text-primary hover:underline" href="./hotel.html">See All</a>
</div>
<div class="mt-6 grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3" id="stays-grid">
<!-- Placeholder for accommodation cards -->
<div class="h-64 rounded-lg bg-card-light dark:bg-card-dark shadow-sm flex items-center justify-center text-muted-light dark:text-muted-dark text-sm">Loading stays...</div>
<div class="h-64 rounded-lg bg-card-light dark:bg-card-dark shadow-sm flex items-center justify-center text-muted-light dark:text-muted-dark text-sm">Loading stays...</div>
<div class="h-64 rounded-lg bg-card-light dark:bg-card-dark shadow-sm flex items-center justify-center text-muted-light dark:text-muted-dark text-sm">Loading stays...</div>
</div>
</section>
</main>
</div>
</div>
<script type="module" src="./firebase_config.js"></script>
<script type="module" src="./auth_ui.js"></script>
<script type="module">
    import { db } from './firebase_config.js';
    import { collection, getDocs, limit, query as firestoreQuery } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-firestore.js";
 
    const OVERPASS_API_URL = "https://overpass-api.de/api/interpreter";
    const DEFAULT_PLACEHOLDER_IMAGE = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='300' viewBox='0 0 400 300'%3E%3Crect width='100%' height='100%' fill='%23e5e7eb'/%3E%3Ctext x='50%' y='50%' font-family='sans-serif' font-size='16px' fill='%239ca3af' dominant-baseline='middle' text-anchor='middle'%3EImage not available%3C/text%3E%3C/svg%3E";
 
    /**
     * Creates an HTML element for a destination card.
     * @param {object} dest - The destination data.
     * @returns {HTMLElement} The card element.
     */
    function createDestinationCard(dest) {
        const card = document.createElement('a');
        card.href = `./destination.html?id=${dest.id}`;
        card.className = "group flex flex-col overflow-hidden rounded-lg bg-card-light dark:bg-card-dark shadow-sm transition-shadow duration-300 hover:shadow-xl";
 
        const tagsHtml = dest.tags.map(tag => 
            `<span class="rounded-full bg-primary/20 px-3 py-1 text-xs font-medium text-primary">${tag}</span>`
        ).join('');
 
        card.innerHTML = `
            <div class="relative overflow-hidden">
                <img class="h-48 w-full object-cover transition-transform duration-300 group-hover:scale-105" src="${dest.imageUrl}" alt="${dest.altText}" onerror="this.onerror=null;this.src='${DEFAULT_PLACEHOLDER_IMAGE}';">
                <button class="absolute top-3 right-3 flex h-8 w-8 items-center justify-center rounded-full bg-white/20 text-white backdrop-blur-sm transition-colors hover:bg-white/40">
                    <span class="material-symbols-outlined text-xl">favorite_border</span>
                </button>
            </div>
            <div class="flex flex-1 flex-col p-4">
                <h4 class="text-lg font-bold">${dest.name}</h4>
                <p class="mt-1 text-sm text-muted-light dark:text-muted-dark">${dest.description}</p>
                <div class="mt-auto pt-4 flex flex-wrap items-center gap-2">
                    ${tagsHtml}
                    <span class="flex items-center gap-1 rounded-full bg-slate-100 dark:bg-slate-800 px-3 py-1 text-xs font-medium text-text-light dark:text-text-dark">
                        <span class="material-symbols-outlined !text-sm text-amber-500">star</span>${dest.rating}
                    </span>
                </div>
            </div>
        `;
        return card;
    }
 
    /**
     * Creates a simple overlay card for things like food trails and stays.
     * @param {object} item - The item data.
     * @returns {HTMLElement} The card element.
     */
    function createSimpleCard(item) {
        const card = document.createElement('div');
        card.className = "group relative h-64 flex items-end justify-start rounded-lg bg-card-light dark:bg-card-dark shadow-sm overflow-hidden p-4 text-white";
        card.innerHTML = `
            <div class="absolute inset-0 bg-cover bg-center transition-transform duration-300 group-hover:scale-105" style="background-image: linear-gradient(to top, rgba(0,0,0,0.7), transparent), url('${item.imageUrl}')"></div>
            <div class="relative z-10">
                 <h4 class="text-lg font-bold">${item.name}</h4>
                 <p class="text-sm text-white/80">${item.description}</p>
            </div>
        `;
        return card;
    }
 
    /**
     * Fetches data from the Overpass API.
     * @param {string} query - The Overpass QL query part.
     * @returns {Promise<Array>} A promise that resolves to an array of elements.
     */
    async function fetchOverpassData(query) {
        let attempts = 0;
        const maxAttempts = 3;
        let delay = 1000; // Initial delay of 1 second

        while (attempts < maxAttempts) {
            try {
                const response = await fetch(OVERPASS_API_URL, {
                    method: 'POST',
                    body: `[out:json];${query}`
                });
                if (!response.ok) {
                    throw new Error(`Overpass API request failed: ${response.statusText}`);
                }
                const data = await response.json();
                return data.elements;
            } catch (error) {
                attempts++;
                console.error(`Attempt ${attempts} failed:`, error);
                if (attempts === maxAttempts) throw error; // If it's the last attempt, re-throw the error
                await new Promise(resolve => setTimeout(resolve, delay)); // Wait before retrying
                delay *= 2; // Exponential backoff - double the delay for the next attempt
            }
        }
    }
 
    /**
     * Renders a grid section using data from the Overpass API.
     * @param {string} gridId - The ID of the grid container element.
     * @param {string} overpassQuery - The Overpass QL query.
     * @param {number} itemLimit - The maximum number of items to render.
     * @param {string} placeholderImageQuery - The search term for Unsplash placeholder images.
     */
    async function renderOverpassSection(gridId, overpassQuery, itemLimit, placeholderImageQuery) {
        const grid = document.getElementById(gridId);
        // Initial state is already set by the static HTML placeholders
        try {
            const items = await fetchOverpassData(overpassQuery);
            if (!items || items.length === 0) {
                grid.innerHTML = `<p class="col-span-full text-center text-muted-light dark:text-muted-dark">No items found via Overpass API.</p>`;
                return;
            }
 
            grid.innerHTML = ''; // Clear loading placeholders
            
            // Shuffle and slice the results to get a random set
            const randomItems = items.sort(() => 0.5 - Math.random()).slice(0, itemLimit);
 
            randomItems.forEach((item, index) => {
                const cardData = {
                    name: item.tags.name || "Unnamed Place",
                    description: item.tags.cuisine ? `Cuisine: ${item.tags.cuisine.split(';').map(c => c.charAt(0).toUpperCase() + c.slice(1)).join(', ')}` : (item.tags.amenity || item.tags.tourism || "Cultural Spot"),
                    // Using a dynamic image service as OSM doesn't provide images
                    imageUrl: `https://source.unsplash.com/800x600/?${placeholderImageQuery},${index}`
                };
                grid.append(createSimpleCard(cardData));
            });
        } catch (error) {
            console.error(`Error fetching Overpass data for ${gridId}: `, error);
            grid.innerHTML = `<p class="col-span-full text-center text-red-500">Could not load items. The external service may be temporarily unavailable.</p>`;
        }
    }
 
    /**
     * Renders a grid section using data from a Firestore collection.
     * @param {string} collectionName - The name of the Firestore collection.
     * @param {string} gridId - The ID of the grid container element.
     * @param {Function} cardCreator - The function to create a card element.
     * @param {number} itemLimit - The maximum number of items to render.
     */
    async function renderFirestoreSection(collectionName, gridId, cardCreator, itemLimit) {
        const grid = document.getElementById(gridId);
        // Initial state is already set by the static HTML placeholders
        try {
            const q = firestoreQuery(collection(db, collectionName), limit(itemLimit));
            const querySnapshot = await getDocs(q);
            if (querySnapshot.empty) {
                grid.innerHTML = `<p class="col-span-full text-center text-muted-light dark:text-muted-dark">No items found in ${collectionName}.</p>`;
                return;
            }
            grid.innerHTML = ''; // Clear loading placeholders
            const cardElements = querySnapshot.docs.map(doc => cardCreator({ id: doc.id, ...doc.data() }));
            grid.append(...cardElements);
        } catch (error) {
            console.error(`Error fetching ${collectionName}: `, error);
            grid.innerHTML = `<p class="col-span-full text-center text-red-500">Error loading items. Please try again later.</p>`;
        }
    }
 
    // --- Static Data for Development ---

    const staticDestinations = [
        {
            id: 'dest1',
            name: 'Jaipur, Rajasthan',
            description: 'The Pink City, known for its stunning forts, palaces, and vibrant markets.',
            imageUrl: 'https://source.unsplash.com/800x600/?jaipur,palace',
            altText: 'Hawa Mahal in Jaipur',
            tags: ['History & Heritage', 'Art & Artisans'],
            rating: 4.9,
            price: 28000
        },
        {
            id: 'dest2',
            name: 'Varanasi, Uttar Pradesh',
            description: 'A spiritual city on the banks of the Ganges, with ancient rituals and narrow alleys.',
            imageUrl: 'https://source.unsplash.com/800x600/?varanasi,ganges',
            altText: 'Ghats of Varanasi at sunrise',
            tags: ['History & Heritage', 'Local Lifestyle'],
            rating: 4.8,
            price: 12000
        },
        {
            id: 'dest3',
            name: 'Kerala Backwaters',
            description: 'God\'s Own Country, famous for its serene backwaters and lush greenery.',
            imageUrl: 'https://source.unsplash.com/800x600/?kerala,backwaters',
            altText: 'A houseboat on the Kerala backwaters',
            tags: ['Local Lifestyle', 'Nature'],
            rating: 4.7,
            price: 50000
        },
        {
            id: 'dest4',
            name: 'Goa',
            description: 'A coastal paradise with beautiful beaches, Portuguese architecture, and a laid-back vibe.',
            imageUrl: 'https://source.unsplash.com/800x600/?goa,beach',
            altText: 'A sunny beach in Goa',
            tags: ['Culinary Delights', 'History & Heritage'],
            rating: 4.9,
            price: 68000
        }
    ];

    const staticFoodTrails = [
        { name: 'Delhi Street Food Crawl', description: 'Explore the chaotic and delicious food scene of Old Delhi.', imageUrl: 'https://source.unsplash.com/800x600/?delhi,food' },
        { name: 'Mumbai Vada Pav Trail', description: 'A journey to find the best Vada Pav in its city of origin.', imageUrl: 'https://source.unsplash.com/800x600/?mumbai,street,food' },
        { name: 'Hyderabadi Biryani Quest', description: 'Savor the rich and aromatic flavors of authentic Hyderabadi Biryani.', imageUrl: 'https://source.unsplash.com/800x600/?biryani,food' },
        { name: 'Kolkata Sweets Tour', description: 'Indulge in the legendary sweet shops and desserts of Kolkata.', imageUrl: 'https://source.unsplash.com/800x600/?kolkata,sweets' }
    ];

    const staticStays = [
        { name: 'Kerala Houseboat', description: 'Float along the serene backwaters in a traditional Kettuvallam.', imageUrl: 'https://source.unsplash.com/800x600/?kerala,houseboat' },
        { name: 'Rajasthan Haveli Stay', description: 'Stay in a historic, intricately carved mansion in the heart of Rajasthan.', imageUrl: 'https://source.unsplash.com/800x600/?rajasthan,haveli' },
        { name: 'Himalayan Homestay', description: 'Experience tranquility and stunning mountain views in a cozy homestay.', imageUrl: 'https://source.unsplash.com/800x600/?himalayas,homestay' }
    ];

    function renderStaticGrid(gridId, data, cardCreator) {
        const grid = document.getElementById(gridId);
        if (!grid) return;
        grid.innerHTML = ''; // Clear loading placeholders
        const cardElements = data.map(item => cardCreator(item));
        grid.append(...cardElements);
    }

    function applyAllFilters() {
        const searchTerm = document.getElementById('search-input').value.toLowerCase();
        const filterCheckboxes = document.querySelectorAll('#interest-filters input[type="checkbox"]');
        const maxPrice = document.getElementById('price-range-slider').value;
        const selectedTags = [];
        filterCheckboxes.forEach(checkbox => {
            if (checkbox.checked) {
                // Get the text from the <p> tag within the same <label>
                const labelText = checkbox.nextElementSibling.textContent;
                selectedTags.push(labelText);
            }
        });

        const filteredDestinations = staticDestinations.filter(destination => {
            const nameMatch = destination.name.toLowerCase().includes(searchTerm);
            
            // If no tags are selected, tag check should be true. Otherwise, check for a match.
            const tagMatch = selectedTags.length === 0 || destination.tags.some(tag => selectedTags.includes(tag));

            const priceMatch = destination.price <= maxPrice;

            return nameMatch && tagMatch && priceMatch;
        });

        renderStaticGrid('destinations-grid', filteredDestinations, createDestinationCard);
    }

    // --- Initial data load ---
    document.addEventListener('DOMContentLoaded', () => {
        const searchInput = document.getElementById('search-input');
        const filterCheckboxes = document.querySelectorAll('#interest-filters input[type="checkbox"]');
        const priceSlider = document.getElementById('price-range-slider');
        const priceValue = document.getElementById('price-range-value');
        const applyBtn = document.getElementById('apply-filters-btn');
        const resetBtn = document.getElementById('reset-filters-btn');

        // Initial render with filters applied (all are checked by default in the HTML)
        applyAllFilters();
        renderStaticGrid('food-trails-grid', staticFoodTrails, createSimpleCard);
        renderStaticGrid('stays-grid', staticStays, createSimpleCard);

        // --- Event Listeners ---

        // Change button to redirect to a search results page
        applyBtn.addEventListener('click', () => {
            const searchTerm = searchInput.value.trim();
            if (searchTerm) {
                window.location.href = `./search-results.html?q=${encodeURIComponent(searchTerm)}`;
            }
        });

        // Also apply filters when typing in search
        searchInput.addEventListener('input', applyAllFilters);

        // Update price value display and filter when slider moves
        priceSlider.addEventListener('input', () => {
            priceValue.textContent = `₹${parseInt(priceSlider.value).toLocaleString('en-IN')}`;
            // We can call applyAllFilters directly for a live update
            applyAllFilters();
        });

        // Reset all filters
        resetBtn.addEventListener('click', () => {
            searchInput.value = '';
            filterCheckboxes.forEach(checkbox => {
                checkbox.checked = false;
            });
            priceSlider.value = priceSlider.max;
            priceValue.textContent = `₹${parseInt(priceSlider.max).toLocaleString('en-IN')}`;
            // Re-apply filters to show all destinations
            applyAllFilters();
        });
    });

</script>
</body></html>